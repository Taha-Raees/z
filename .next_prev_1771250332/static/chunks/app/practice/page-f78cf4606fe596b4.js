(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{487:(e,s,t)=>{"use strict";t.d(s,{PracticeSetRunner:()=>c});var n=t(5155),r=t(2619),a=t.n(r),o=t(2115),i=t(5261),l=t(9439);function d(e){return(e||"").toLowerCase()}function c(e){let{exerciseSetId:s,lessonId:t,title:r,description:c,questions:u}=e,[m,p]=(0,o.useState)(!1),[x,b]=(0,o.useState)(!1),[h,g]=(0,o.useState)(null),[f,y]=(0,o.useState)(null),[v,j]=(0,o.useState)(()=>u.map(e=>{let s=d(e.type);return"mcq"===s||"true_false"===s?null:""})),N=(0,o.useMemo)(()=>0!==u.length&&v.every((e,s)=>{var t;let n=d(null==(t=u[s])?void 0:t.type);return"mcq"===n||"true_false"===n?null!==e:"string"==typeof e?e.trim().length>0:!!e}),[v,u]),S=async()=>{b(!0),g(null);try{let e=await (0,l.M)({exerciseSetId:s,answers:v});y(e)}catch(e){g(e instanceof Error?e.message:"Submission failed")}finally{b(!1)}};return(0,n.jsx)(i.Zp,{className:"mt-3 border-border/70 bg-muted/20",children:(0,n.jsxs)(i.Wu,{className:"p-3",children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:c}),m?(0,n.jsx)(i.Ex,{variant:"warn",children:"In progress"}):(0,n.jsx)(i.$n,{onClick:()=>{p(!0),y(null),g(null)},size:"sm",children:"Start set"})]}),m?(0,n.jsxs)("div",{className:"space-y-3",children:[u.map((e,t)=>(0,n.jsx)(i._d,{id:"".concat(s,"-q-").concat(t),index:t,type:e.type,prompt:e.question||e.prompt||"Question unavailable",options:e.options,value:v[t],onChange:e=>{j(s=>{let n=[...s];return n[t]=e,n})},compact:!0},"".concat(s,"-runner-").concat(t))),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.$n,{onClick:S,disabled:!N||x,size:"sm",children:x?"Submitting...":"Submit attempt"}),(0,n.jsx)(a(),{href:"/lessons/".concat(t),className:"text-xs font-semibold text-primary hover:underline",children:"Back to lesson"})]}),h?(0,n.jsx)("p",{className:"rounded-lg border border-danger/20 bg-danger/10 px-2 py-1 text-xs text-danger",children:h}):null,f?(0,n.jsxs)("p",{className:"rounded-lg border border-success/20 bg-success/10 px-2 py-1 text-xs text-success",children:["Score: ",Math.round(f.grading.score),"% â€¢ ",f.grading.passed?"Passed":"Needs review"]}):null,(null==f?void 0:f.grading.feedback)?(0,n.jsx)("p",{className:"rounded-lg border border-info/20 bg-info/10 px-2 py-1 text-xs text-info",children:f.grading.feedback}):null,f?(0,n.jsxs)("p",{className:"text-[10px] text-muted-foreground",children:["Attempt recorded: ",f.attemptId]}):null]}):(0,n.jsx)("p",{className:"text-[11px] text-muted-foreground",children:"Open the workbook to answer and submit for grading."}),(0,n.jsxs)("p",{className:"mt-2 text-[10px] text-muted-foreground",children:["Workbook: ",r]})]})})}},2763:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2619,23)),Promise.resolve().then(t.bind(t,487)),Promise.resolve().then(t.bind(t,7539)),Promise.resolve().then(t.bind(t,814)),Promise.resolve().then(t.bind(t,6294)),Promise.resolve().then(t.bind(t,7091)),Promise.resolve().then(t.bind(t,7777)),Promise.resolve().then(t.bind(t,3406))},9439:(e,s,t)=>{"use strict";t.d(s,{M:()=>r,k:()=>a});var n=t(9893);async function r(e){return(0,n.n)("/api/exercises/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function a(e){return(0,n.n)("/api/assessments/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}},e=>{e.O(0,[619,16,434,441,255,358],()=>e(e.s=2763)),_N_E=e.O()}]);