"use strict";exports.id=586,exports.ids=[586],exports.modules={5008:(a,b,c)=>{c.d(b,{$:()=>h});var d=c(42082),e=c(6563);class f{async gradeObjectiveAssessment(a,b){let c=0,d=[];for(let e=0;e<a.length;e++){let f,g=a[e],h=b[e],i=!1,j="";switch(g.type){case"mcq":i=h===g.correctAnswer,f=g.options[g.correctAnswer],j=i?"Correct!":`Incorrect. The correct answer is: ${f}`;break;case"true_false":i=h===g.correctAnswer,f=g.correctAnswer.toString(),j=i?"Correct!":`Incorrect. The answer is: ${f}`;break;case"cloze":let k=g.blanks.find(a=>a.index===e);i=!!k&&h===k.answer,f=k?.answer,j=i?"Correct!":`Incorrect. The correct answer is: ${f}`;break;case"short_answer":let l=h?.toLowerCase()||"";i=g.keywords.some(a=>l.includes(a.toLowerCase())),f=g.expectedAnswer,j=i?"Good answer!":`Your answer should include: ${g.keywords.join(", ")}`;break;case"matching":i=!0,j="Matching completed";break;case"reading":i=h===g.correctAnswer,f=g.correctAnswer,j=i?"Correct!":"Incorrect. Review the passage again.";break;case"listening":i=h===g.correctAnswer,f=g.correctAnswer,j=i?"Correct!":"Incorrect. Listen again and try once more.";break;default:j="Question type not supported for auto-grading"}i&&c++,d.push({questionIndex:e,score:100*!!i,feedback:j,correctAnswer:f})}let e=c/a.length*100,f=e>=70,g=await this.generateImprovementPlan(a,d,e);return{score:e,passed:f,feedback:this.generateOverallFeedback(e,f),detailedFeedback:d,improvementPlan:g}}async gradeSubjectiveAssessment(a,b,c){let d="speaking"===a.type||"writing"===a.type?a.prompt:a.question,f=[{role:"system",content:`You are an expert grader at a prestigious educational institution. Grade student submissions fairly and constructively.

Grading principles:
1. Use the provided rubric consistently
2. Provide specific, actionable feedback
3. Be encouraging while being honest
4. Point out strengths and areas for improvement
5. Suggest specific resources for improvement`},{role:"user",content:`Grade this student submission:

Question: ${d}
Student Answer: ${b}

Rubric:
${JSON.stringify(c,null,2)}

Grade the submission following the rubric. For each criterion:
- Assign a score based on the levels
- Provide specific feedback explaining the score

Return as JSON with structure:
{
  score: number (0-100),
  passed: boolean,
  feedback: string (overall feedback),
  detailedFeedback: [
    {
      criterion: string,
      score: number,
      maxPoints: number,
      feedback: string
    }
  ],
  improvementPlan: [
    {
      topic: string,
      action: string,
      resources: string[] (optional)
    }
  ]
}`}],g=await this.client.chatCompletion({messages:f,temperature:.7,priority:"standard"}),h=g.selectedResult.choices[0]?.message?.content;if(!h)throw Error("No content in response");let i=JSON.parse(h);return e.vr.parse(i)}generateOverallFeedback(a,b){return a>=90?"Excellent work! You have demonstrated a strong understanding of the material.":a>=80?"Great job! You have a good grasp of the concepts with minor areas for improvement.":a>=70?"Good effort! You have met the passing threshold. Review the feedback to strengthen your understanding.":a>=60?"You're making progress, but need to review the material more thoroughly. Focus on the areas where you struggled.":"This assessment indicates you need to review the material more carefully. Consider revisiting the lessons and trying again."}async generateImprovementPlan(a,b,c){let d=b.filter(a=>a.score<70);if(0===d.length)return[];let e=[...new Set(d.map((b,c)=>{let d=a[b.questionIndex];return"reading"===d.type?"Reading comprehension":"listening"===d.type?"Listening comprehension":"speaking"===d.type?"Speaking skills":"writing"===d.type?"Writing skills":"General concepts"}))],f=[{role:"system",content:"You are an expert educator. Create actionable improvement plans for students."},{role:"user",content:`Create an improvement plan for a student who scored ${c}%.

Weak areas: ${e.join(", ")}

For each weak area, provide:
- The topic
- A specific action the student can take
- 1-2 suggested resources (optional)

Return as JSON array with fields: topic, action, resources.`}],g=await this.client.chatCompletion({messages:f,temperature:.7,priority:"standard"}),h=g.selectedResult.choices[0]?.message?.content;if(!h)return[];try{let a=JSON.parse(h);return Array.isArray(a)?a:[]}catch{return[]}}async gradeAssessmentAttempt(a,b){let c=a.questions||[];if(!c.some(a=>"speaking"===a.type||"writing"===a.type))return await this.gradeObjectiveAssessment(c,b);{let d=[],e=0;for(let f=0;f<c.length;f++){let g=c[f],h=b[f];if("speaking"===g.type||"writing"===g.type){let b=await this.gradeSubjectiveAssessment(g,h,g.rubric||a.rubric);d.push(...b.detailedFeedback),e+=b.score}else{let a=this.checkObjectiveAnswer(g,h);d.push({questionIndex:f,score:100*!!a,feedback:a?"Correct!":"Incorrect"}),e+=100*!!a}}let f=e/c.length;return{score:f,passed:f>=70,feedback:this.generateOverallFeedback(f,f>=70),detailedFeedback:d,improvementPlan:[]}}}checkObjectiveAnswer(a,b){switch(a.type){case"mcq":case"true_false":return b===a.correctAnswer;case"cloze":let c=a.blanks.find(a=>0===a.index);return!!c&&b===c.answer;case"short_answer":let d=b?.toLowerCase()||"";return a.keywords.some(a=>d.includes(a.toLowerCase()));default:return!1}}constructor(){this.client=(0,d.z)()}}let g=null;function h(){return g||(g=new f),g}},6563:(a,b,c)=>{c.d(b,{NI:()=>g,P1:()=>e,Vf:()=>v,Xf:()=>h,ep:()=>t,lG:()=>i,s1:()=>w,vr:()=>x});var d=c(40197);let e=d.Ik({topic:d.Yj().describe("The subject/topic the student wants to learn"),currentLevel:d.Yj().describe("Current proficiency level (e.g., A1, beginner, intermediate)"),goalLevel:d.Yj().describe("Target proficiency level (e.g., B1, advanced)"),targetDate:d.Yj().describe("Target completion date (ISO format)"),contentLanguage:d.Yj().default("English").describe("Target language used for learner-facing generated content"),instructionLanguage:d.Yj().default("English").describe("Language used for UI/system instruction text"),strictTargetLanguage:d.zM().default(!0).describe("When true, generated learner content must remain in contentLanguage"),hoursPerDay:d.ai().min(.5).max(12).describe("Available hours per day"),hoursPerWeek:d.ai().min(1).max(84).describe("Available hours per week"),pacePreference:d.k5(["intensive","normal","light"]).describe("Preferred learning pace"),learningPreferences:d.Ik({videoPreference:d.ai().min(0).max(100).describe("Percentage of video content preferred"),readingPreference:d.ai().min(0).max(100).describe("Percentage of reading content preferred"),speakingFocus:d.zM().describe("Whether to focus on speaking practice"),writingFocus:d.zM().describe("Whether to focus on writing practice"),listeningFocus:d.zM().describe("Whether to focus on listening practice")}),constraints:d.Ik({device:d.Yj().optional().describe("Device constraints (mobile, desktop, etc.)"),accessibility:d.Yj().optional().describe("Accessibility requirements"),examFormat:d.Yj().optional().describe("Target exam format if any")}),additionalNotes:d.Yj().optional().describe("Any additional notes or requirements")}),f=d.Ik({index:d.ai(),title:d.Yj(),description:d.Yj(),outcomes:d.YO(d.Yj()),estimatedHours:d.ai(),lessonsCount:d.ai()});d.Ik({index:d.ai(),title:d.Yj(),description:d.Yj(),objectives:d.YO(d.Yj()),estimatedMinutes:d.ai(),keyTopics:d.YO(d.Yj()),prerequisites:d.YO(d.Yj()).optional()});let g=d.Ik({title:d.Yj(),description:d.Yj(),modules:d.YO(f),totalLessons:d.ai(),totalHours:d.ai(),estimatedWeeks:d.ai(),milestones:d.YO(d.Ik({title:d.Yj(),week:d.ai(),description:d.Yj()}))}),h=d.Ik({type:d.k5(["youtube","article","book","podcast","other"]),title:d.Yj(),url:d.Yj().url(),description:d.Yj(),durationSeconds:d.ai().nullable().optional(),channel:d.Yj().nullable().optional(),qualityScore:d.ai().min(0).max(1),relevanceScore:d.ai().min(0).max(1),reason:d.Yj().describe("Why this resource was selected")}),i=d.Ik({summary:d.Yj(),keyPoints:d.YO(d.Yj()),glossary:d.YO(d.Ik({term:d.Yj(),definition:d.Yj(),example:d.Yj().optional()})),guidedNotes:d.YO(d.Ik({section:d.Yj(),content:d.Yj(),questions:d.YO(d.Yj()).optional()})),additionalResources:d.YO(d.Ik({title:d.Yj(),url:d.Yj(),description:d.Yj().optional()})).optional()}),j=d.Ik({type:d.eu("mcq"),question:d.Yj(),options:d.YO(d.Yj()),correctAnswer:d.ai(),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),k=d.Ik({type:d.eu("true_false"),question:d.Yj(),correctAnswer:d.zM(),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),l=d.Ik({type:d.eu("matching"),question:d.Yj(),pairs:d.YO(d.Ik({left:d.Yj(),right:d.Yj()})),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),m=d.Ik({type:d.eu("cloze"),question:d.Yj(),blanks:d.YO(d.Ik({index:d.ai(),answer:d.Yj(),alternatives:d.YO(d.Yj()).optional()})),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),n=d.Ik({type:d.eu("short_answer"),question:d.Yj(),expectedAnswer:d.Yj(),keywords:d.YO(d.Yj()),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),o=d.Ik({type:d.eu("listening"),question:d.Yj(),audioUrl:d.Yj().url().optional(),transcript:d.Yj().optional(),correctAnswer:d.Yj(),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),p=d.Ik({type:d.eu("reading"),passage:d.Yj(),question:d.Yj(),correctAnswer:d.Yj(),explanation:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"])}),q=d.Ik({type:d.eu("speaking"),prompt:d.Yj(),rubric:d.Ik({criteria:d.YO(d.Ik({name:d.Yj(),description:d.Yj(),maxPoints:d.ai()}))}),timeLimitSeconds:d.ai().optional(),difficulty:d.k5(["beginner","intermediate","advanced"])}),r=d.Ik({type:d.eu("writing"),prompt:d.Yj(),rubric:d.Ik({criteria:d.YO(d.Ik({name:d.Yj(),description:d.Yj(),maxPoints:d.ai()}))}),wordLimit:d.Ik({min:d.ai(),max:d.ai()}).optional(),difficulty:d.k5(["beginner","intermediate","advanced"])}),s=d.gM("type",[j,k,l,m,n,o,p,q,r]),t=d.Ik({title:d.Yj(),description:d.Yj(),difficulty:d.k5(["beginner","intermediate","advanced"]),type:d.k5(["mixed","reading","listening","speaking","writing","grammar","vocabulary"]),estimatedMinutes:d.ai(),questions:d.YO(s),instructions:d.Yj().optional()}),u=d.Ik({name:d.Yj(),description:d.Yj(),maxPoints:d.ai(),levels:d.YO(d.Ik({score:d.ai(),description:d.Yj()}))}),v=d.Ik({criteria:d.YO(u),totalPoints:d.ai(),passingScore:d.ai()}),w=d.Ik({type:d.k5(["quiz","test","exam"]),title:d.Yj(),description:d.Yj(),timeLimitMinutes:d.ai().optional(),questions:d.YO(s),rubric:v.optional(),passingScore:d.ai(),instructions:d.Yj().optional()}),x=d.Ik({score:d.ai().min(0).max(100),passed:d.zM(),feedback:d.Yj(),detailedFeedback:d.YO(d.Ik({questionIndex:d.ai(),score:d.ai(),feedback:d.Yj(),correctAnswer:d.Yj().optional()})),improvementPlan:d.YO(d.Ik({topic:d.Yj(),action:d.Yj(),resources:d.YO(d.Yj()).optional()}))}),y=d.Ik({type:d.k5(["lesson","exercise","quiz","test","exam","review","break"]),title:d.Yj(),description:d.Yj(),estimatedMinutes:d.ai(),priority:d.k5(["high","medium","low"]),completed:d.zM().default(!1),refId:d.Yj().optional()});d.Ik({date:d.Yj(),totalEstimatedMinutes:d.ai(),items:d.YO(y),notes:d.Yj().optional(),focusAreas:d.YO(d.Yj()).optional()}),d.Ik({agentName:d.Yj(),timestamp:d.Yj(),success:d.zM(),data:d.bz().optional(),error:d.Yj().optional(),metadata:d.g1(d.Yj(),d.bz()).optional()})},35517:(a,b,c)=>{c.d(b,{m:()=>e});var d=c(96798);async function e(){let a=await d.z.user.findFirst({orderBy:{createdAt:"asc"}});return a||d.z.user.create({data:{email:function(){let a=Date.now(),b=Math.random().toString(36).slice(2,8);return`local-${a}-${b}@local.school`}(),name:"Student"}})}}};